<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab 1 - Fast Robots</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <script src="scripts.js"></script>
    <div class="container">
        <aside class="sidebar">
            <div class="profile">
                <h1>Fast Robots</h1>
                <h3>Spring 2025</h3>
            </div>
            <nav>
                <ul>
                    <li>
                        <h3>Lab 1 - Artemis & Bluetooth</h3>
                    </li>
                    <li>
                        <a href="index.html">
                            <h4>Home</h4>
                        </a>
                    </li>
                    <li>
                        <a href="#objective">
                            <h4>Objective</h4>
                        </a>
                    </li>

                    <li>
                        <h4 class="collapsible">Lab 1A</h4>
                        <ul class="collapsible-content">
                            <li><a href="#lab-1a">Overview</a></li>
                            <li><a href="#blink">Example 1: Blink</a></li>
                            <li><a href="#serial">Example 2: Serial</a></li>
                            <li><a href="#analog-read">Example 3: Analog Read</a></li>
                            <li><a href="#microphone-output">Example 4: Microphone</a></li>
                            <li><a href="#blink-cnote">Blink w/ Microphone (5160)</a></li>
                        </ul>
                    </li>

                    <li>
                        <h4 class="collapsible">Lab 1B</h4>
                        <ul class="collapsible-content">
                            <li><a href="#lab-1b">Overview</a></li>
                            <li><a href="#ECHO">Task 1: ECHO</a></li>
                            <li><a href="#SEND_THREE_FLOATS">Task 2: SEND_THREE_FLOATS</a></li>
                            <li><a href="#GET_TIME_MILLIS">Task 3: GET_TIME_MILLIS</a></li>
                            <li><a href="#notification-handler">Task 4: Notification Handler</a></li>
                            <li><a href="#message-speed">Task 5: Message Speed</a></li>
                            <li><a href="#SEND_TIME_DATA">Task 6: SEND_TIME_DATA</a></li>
                            <li><a href="#GET_TEMP_READINGS">Task 7: GET_TEMP_READINGS</a></li>
                            <li><a href="#comparison">Task 8: Data Collection Method Comparison</a></li>
                        </ul>
                    </li>

                </ul>
            </nav>
        </aside>

        <main class="content">
            <section class="lab-content">
                <div class="general-text">

                    <h2>Lab 1: Artemis & Bluetooth</h2>

                    <p><i>01.21.2025 - 01.28.2025</i></p>

                    <section id="objective">
                        <h3>Objective</h3>
                    </section>

                    <p>Lab 1 is split into two parts, 1A and 1B. The overall objective of this lab was to set up and
                        familiarize myself with the Arduino IDE and the Artemis board. Lab tasks included programming
                        the board, reading & writing serial messages over USB, using the onboard temperature sensor and
                        microphone, and communicating between my computer (Jupyter notebook) and the Artemis board
                        through Bluetooth.</p>

                    <section id="lab-1a">
                        <h3>Lab 1A</h3>

                        <p>I first installed Arduino IDE and made sure that it was updated to the most recent version. I
                            also followed the set up instructions to install the correct board and libraries. After
                            hooking up the Artemis board to my computer and selecting the correct Board and Port, I
                            moved on to the tasks.</p>

                    </section>

                    <section id="blink">

                        <h4>Example 1: Blink</h4>
                        <p>The first example code we ran was blink, which made the LED on the board to turn on and off.
                            I was able to upload and run the code with no issues. You can see the board executing the
                            program below:</p>

                        <iframe width="700" height="500" src="https://www.youtube.com/embed/Y12J--JkmSA"
                            title="ECE 4160 - Blink" frameborder="0"
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                            allowfullscreen></iframe>

                    </section>

                    <section id="serial">

                        <h4>Example 2: Serial</h4>
                        <p>I then uploaded and ran the next example, Serial. This code allowed me to type characters in
                            the Serial monitor and then receive the same input characters as outputs, also in the Serial
                            monitor.</p>

                        <iframe width="700" height="500" src="https://www.youtube.com/embed/yb4gLH2N_Fk"
                            title="ECE 4160 - Serial" frameborder="0"
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                            allowfullscreen></iframe>

                    </section>

                    <section id="analog-read">
                        <h4>Example 3: Analog Read</h4>
                        <p>The third example file was analogRead, which utilized the on board temperature sensor. The
                            temperature measurements were outputted to the serial monitor, and I tested the sensor by
                            holding the board in my hand to warm it up. As seen in the video below, the temperature did
                            increase when I held the board.</p>

                        <iframe width="700" height="500" src="https://www.youtube.com/embed/1iYDIWScxgc"
                            title="ECE 4160 - Analog Read" frameborder="0"
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                            allowfullscreen></iframe>

                    </section>

                    <section id="microphone-output">

                        <h4>Example 4: Microphone Output</h4>
                        <p>The last example had me test the microphone on the Artemis board. The frequency measurements
                            were outputted to the Serial Monitor. I tested whistling, and the frequency increased
                            accordingly.</p>

                        <iframe width="700" height="500" src="https://www.youtube.com/embed/6A2xySlCDnA"
                            title="ECE 4160 - Microphone Output" frameborder="0"
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                            allowfullscreen></iframe>

                    </section>

                    <section id="blink-cnote">
                        <h4>Blink & Microphone (additional task for 5000-level students)</h4>
                        <p>I also decided to do the graduate level task, which was to create a program that would make
                            the Artemis board blink the LED only when it detected a musical “C” note. I did this by
                            creating a new file, and referencing the Blink and Microphone Output examples to run the
                            blink code only when the detected frquency was in the "C" note range. The code can be found
                            on my <a
                                href="https://github.com/luluhtutt/FastRobots/blob/main/labs/lab1/lab_1a.ino">Github</a>.
                        </p>

                        <iframe width="700" height="500" src="https://youtube.com/embed/W6rOO9IkQno"
                            title="ECE 4160 - Blink when C Note" frameborder="0"
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                            allowfullscreen></iframe>

                    </section>
                    <br>

                    <section id="lab-1b">
                        <h3>Lab 1B</h3>

                        <p>I first read through the set up instructions and made sure my Python and pip versions were
                            correct. I also made a virtual environment, installed the necessary packages, and installed
                            the Arduino BLE library. Finally, I downloaded the provided codebase and worked on the tasks
                            using Jupyter lab.</p>

                        <p>Before beginning the tasks, I followed the instructions to get my MAC address, after which I
                            updated the artemis_address in connections.yaml accordingly. The other set up step was
                            generating a UUID, and updating connections.yaml and ble_arduino.ino.</p>

                        <img src="images/lab1_images/mac_address.png" alt="mac_address" class="lab-photo" width="900px">
                        <img src="images/lab1_images/uuid.png" alt="uuid" class="lab-photo" width="400px">

                    </section>

                    <section id="ECHO">

                        <h4>Task 1: ECHO</h4>
                        <p>The first task was to program the board so that I could send a string from my computer to the
                            board using ECHO. The board would then send back to the computer an augmented string."</p>

                        <p>I added the arduino code below to make the board return the user's string when the ECHO
                            command is used.</p>

                        <div class="code-snippet">
                            <pre>
tx_estring_value.clear();
tx_estring_value.append("Robot says -> ");
tx_estring_value.append(char_arr);
tx_estring_value.append(" :)");
tx_characteristic_string.writeValue(tx_estring_value.c_str());</pre>
                        </div>

                        <p>Below, you can see the Python end of ECHO, which send the command to the board, and then
                            receives a string back.</p>

                        <img src="images/lab1_images/1b_task1.png" alt="echo" class="lab-photo" width="500px">

                    </section>

                    <section id="SEND_THREE_FLOATS">

                        <h4>Task 2: SEND_THREE_FLOATS</h4>
                        <p>The next command I completed was SEND_THREE_FLOATS, which would allow me to send three
                            floats from my computer to the artemis board. For the Arduino code, I referenced
                            SEND_TWO_INTS, which was already implemented, and changed the implementation accordingly.
                            Below, you can see the Python code to send the floats, and the Serial Monitor.
                        </p>

                        <img src="images/lab1_images/1b_task2_python.png" alt="three_floats_python" class="lab-photo"
                            height="40px">
                        <img src="images/lab1_images/1b_task2_arduino.png" alt="three_floats_arduino" class="lab-photo"
                            height="40px">

                    </section>

                    <section id="GET_TIME_MILLIS">

                        <h4>Task 3: GET_TIME_MILLIS</h4>
                        <p>This task was to get the current time from the Artemis board and return it as a String to the
                            computer.
                        </p>
                        <p>This Arduino code below uses the millis() method to get the time.</p>

                        <div class="code-snippet">
                            <pre>
tx_estring_value.clear();
tx_estring_value.append("T: ");
tx_estring_value.append(int(millis()));
tx_characteristic_string.writeValue(tx_estring_value.c_str());</pre>
                        </div>

                        <p>And the Python end is shown below.</p>
                        <img src="images/lab1_images/1b_task3.png" alt="get_time_millis" class="lab-photo"
                            width="500px">


                    </section>

                    <section id="notification-handler">

                        <h4>Task 4: Notification Handler</h4>
                        <p>The next few tasks all required the implementation of a notification handler, and Task 4 was
                            to set up a handler which would return the time as a string.
                        </p>

                        <img src="images/lab1_images/1b_task4.png" alt="notif_handler_task4" class="lab-photo"
                            width="500px">

                    </section>

                    <section id="message-speed">

                        <h4>Task 5: Message Speed</h4>
                        <p>For task 5, I wanted to check how fast the board could send messages. To do this, in Arduino,
                            I made a command GET_TIME_LOOP, which repeatedly sent the current time for five seconds:
                        </p>

                        <div class="code-snippet">
                            <pre>
case GET_TIME_LOOP:
{
    unsigned long startMillis = millis();
    int i = 1;

    while(millis() - startMillis < 5000)  {
        tx_estring_value.clear();
        tx_estring_value.append("T: ");
        tx_estring_value.append(int(millis()));
        tx_characteristic_string.writeValue(tx_estring_value.c_str());
        i++;
    }

    break;
}</pre>
                        </div>

                        <p>I modified the notification handler in Python slightly by changing msg to an array instead of
                            a String. This way, I knew how many messages were sent by the Arduino by just checking the
                            length of msg.</p>
                        <img src="images/lab1_images/1b_task5_python.png" alt="task5_python" class="lab-photo"
                            width="500px">

                        <p>Because there were 596 integer messages sent in 5 seconds, I calculated the data transfer
                            rate to be (596 messages * 4 bytes)/5 = 476.8 bytes/second.</p>

                    </section>

                    <section id="SEND_TIME_DATA">

                        <h4>Task 6: SEND_TIME_DATA</h4>
                        <p>In task 6, I explored a different way to get time stamps, and its effect on the data transfer
                            rate. Instead of sending every message within the loop, I created an array and filled it
                            with time stamps. I then looped through that array and sent the messages to my computer.
                        </p>

                        <div class="code-snippet">
                            <pre>
case SEND_TIME_DATA:
{
    unsigned long startMillis = millis();
    int num_msgs = 0;

    // collect time data
    while(millis() - startMillis < 5000)  {
        if (num_msgs < 1000) {
            times[num_msgs] = int(millis());
            num_msgs++;
        }
        delay(50);
    }

    // send time data from the times array to python
    int i = 0;
    while(i <= num_msgs)  {
        tx_estring_value.clear();
        tx_estring_value.append(times[i]);
        tx_characteristic_string.writeValue(tx_estring_value.c_str());
        i++;
    }

    break;
}
                            </pre>
                        </div>

                        <p>I used the same notification handler as in task 5, and got the following data transfer
                            measurements. This came out to be (1001 messages * 4 bytes)/5 second = 800.8 bytes/second.
                        </p>
                        <img src="images/lab1_images/1b_task6_python.png" alt="time_loop_python" class="lab-photo"
                            width="350px">

                    </section>


                    <section id="GET_TEMP_READINGS">

                        <h4>Task 7: GET_TEMP_READINGS</h4>

                        <p>Building from task 6, I added another array to keep track of temperature measurements. The
                            logic was the same as in task 6 as well. Shown below is the updated loop for populating the
                            arrays:
                        </p>

                        <div class="code-snippet">
                            <pre>
while(millis() - startMillis < 5000)  {
    if (num_msgs < 1000) {
        times[num_msgs] = int(millis());
        temps[num_msgs] = float(getTempDegF());
        num_msgs++;
    }
}</pre>
                        </div>

                        <img src="images/lab1_images/1b_task7_python.png" alt="temp_readings_python" class="lab-photo"
                            width="350px">

                        <p>The computer would then receive the time and temperature measurements, which can be seen
                            above.
                        </p>

                    </section>

                    <section id="comparison">
                        <h4>Task 8: Data Collection Method Comparison</h4>

                        <p><b>Method 1</b> had one loop that sent a message every single iteration. This approach would
                            be beneficial in situations where I need real-time monitoring and action. It has a data
                            transfer rate of 476.8 bytes/second. This is slower than the other method, meaning that
                            although it allowed for quick response and action, it is inefficient for data collection and
                            could use too much bandwidth.</p>

                        <p><b>Method 2</b> used a global array and two loops, one that would populate the array, and
                            another that would iterate through the array and send the stored messages. This method is
                            better for data collection purposes, as it sends larger packets of information and thus
                            reduces the comparative overhead of BLE transmissions. There might be a slight delay due to
                            some time allocated at the beginning to collecting data, as well as more memory used for the
                            data arrays. However, it does have a faster data transfer rate (800.8 bytes/second).</p>

                        <p>With the knowledge that the Artemis board has 384 kB of RAM, I calculated roughly how much
                            data can be stored. For a single data type (ie just temperature or just time), we can store
                            384kB / 4B = 96000 messages.</p>

                    </section>

                </div>

            </section>
        </main>
    </div>
</body>

</html>